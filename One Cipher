The One Cipher...
A Authenticated Encryption with Associated Data (AEAD) enhanced Vernan Cipher.
The One Cipher to rule over all others...

"Anyone intelligent can make things bigger and more complex. It takes a touch of genius – and a lot of courage – to move in the opposite direction” —Albert Einstein

public static byte[] XEncrypt(byte[] seed, byte[] iv , byte[] data, byte[] aad = null)
{
    // QRNG 16 byte true random 
    if(iv.Length > _ivssize)
        Array.Copy(iv, 0, iv, 0, _ivssize);

    // Seed KG, with compressed Medley vector set 
    var kg = KeyGenerator.Create(seed, iv);

    // Derive CSBRNG key stream with length of data 
    byte[] keyBytes = kg.KeyGen(data.Length);

    // CipherText or outbytes
    byte[] outBytes = new byte[keyBytes.Length];
    // Check arguments:
    if (data.Length != keyBytes.Length)
        throw new ArgumentException("Byte-arrays are not of same length");

    // Encrypt by vernan XOR:
    for (int i = 0; i < data.Length; i++)
        outBytes[i] = (byte)(data[i] ^ keyBytes[i]);

    // Generate authenticated TAG to address Vernam Cipher malleability
    byte[] _key = seed.Take(32).ToArray(); // take one of the compressed medly set, to generate tag..
    byte[] _tag;

    // Process optional aad
    if (aad == null)
        _tag = ComputeTag(_key, outBytes);
    else
        _tag = ComputeTag(_key, outBytes.Concat(aad).ToArray()); // simple concat as no padding used in vernan ciphers.

    CryptographicOperations.ZeroMemory(keyBytes);
    return iv.Concat(_tag).Concat(outBytes).ToArray();

}

 /// <summary>
 /// HMACSHA256-128
 /// Compute 16 byte (128 bit) Tag
 /// </summary>
 /// <param name="key"></param>
 /// <param name="data"></param>
 /// <returns></returns>
 private static byte[] ComputeTag(byte[] key, byte[] data)
 {
    const int BytesToCopy = 16;
    if (key.Length > 32)
         key = key.Take(32).ToArray();
    byte[] output = new byte[BytesToCopy];
    HMAC hmac = new HMACSHA256(key);
    Array.Copy(hmac.ComputeHash(hashBytes), output, BytesToCopy);
    return output;
 }


